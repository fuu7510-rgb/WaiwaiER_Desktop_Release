# WaiwaiER Desktop リリースノート

## 概要
- チャネル: ALPHA
- 対象OS: Windows
- 配布物: GitHub Releases（このリポジトリのReleasesページ）からダウンロード
  - 配布ZIP（NSIS）: WaiwaiER-Desktop-0.1.7-alpha-win64-nsis.zip
  - 配布ZIP（MSI）: WaiwaiER-Desktop-0.1.7-alpha-win64-msi.zip
- リリース日: 2026-01-07

### ハイライト
- セキュリティ: CSP（Content Security Policy）を有効化し、WebViewの防御を強化
- セキュリティ: ファイルシステムアクセス権限（fs:scope）を必要最小限に縮小
- セキュリティ: `withGlobalTauri` を無効化し、グローバルAPI露出を削減
- セキュリティ: `project_id` のUUID検証を追加し、パストラバーサル耐性を強化
- 開発: `cargo audit` による依存脆弱性スキャン結果をレポート化

- アップデート前バックアップ推奨: 更新前に必ずエクスポート（JSON/パッケージ）などでバックアップしてください。

## インストール
1. 配布ZIP（MSI/NSIS）を展開
2. 展開したインストーラを実行
  - MSI版: `.msi`
  - NSIS版: `.exe`

## 変更点

### 追加
- 開発: 依存関係の脆弱性スキャン結果をレポートとして追加
  - docs/CARGO_AUDIT_REPORT.md
- セキュリティ: セキュリティ調査レポートを追加
  - docs/SECURITY_REVIEW_2026-01-05.md
- ERエディタ: 同期テーブル機能を追加（同じテーブルを別の場所に複製配置して、線の交錯を回避）
  - テーブル設定: 「同期テーブルを作成」「同期を解除」
  - 詳細: docs/SYNC_TABLE_FEATURE.md

### 改善
- セキュリティ: `project_id` にUUID検証を追加（パストラバーサル対策）
- セキュリティ: CSP（Content Security Policy）を有効化
- セキュリティ: `withGlobalTauri` を無効化
- セキュリティ: ファイルシステムアクセス範囲（fs:scope）を必要最小限に縮小
  - 対象: `DOCUMENT` / `DOWNLOAD`
- DSLインポート: テーブル配置アルゴリズムを改善
  - 親テーブル（参照先）を画面左、子テーブル（Refを持つ側）を画面右に自動配置
  - 同階層のテーブルは縦に並べて配置
  - インポート後の手動並べ替えの手間を削減

### 修正
- サイドパネルの「テーブル設定」が一番下までスクロールできず、ウィンドウを大きくしないと同期解除/削除系の操作が表示できない場合がある問題を修正

## 既知の制限
- ALPHAのため、互換性（DB/プロジェクト形式）が将来変更される可能性があります。
- セキュリティ強化により、アプリが直接アクセスできるファイル範囲を縮小しています。
  - 以前アクセスできていた場所（例: Desktop など）で、ファイル操作が失敗する場合があります。
- `cargo audit` の結果、間接依存（Tauriエコシステム由来）に起因する脆弱性・警告が残る場合があります。
  - 可能な範囲で継続監視し、上流アップデートで解消を追跡します。

## 互換性/移行

### バージョン情報（互換性の目安）
- パッケージ内ER図データ世代（diagram schema）
  - 現行: v4
  - この版で読み込み可能: v2〜v4
- `.waiwai` パッケージ形式世代（package format）
  - 現行: v1
  - この版で読み込み可能: v0〜v1

### 段階アップデート（ブリッジ版）
- もしインポート/読み込み時に「古すぎるため読み込めません。中間バージョンを経由して…」が表示された場合は、
  - v0.1.7（この版）で一度 **読み込み→保存（または .waiwai へエクスポート）** して、データを引き上げてください
  - その後、最新版で読み込みを再試行してください

## 不具合報告
- 手順/期待/実際の結果、OS、バージョン（設定→バージョン情報の値）を添えて連絡
- 連絡先: GitHub Issues（配布用Publicリポジトリ）
- 注意: Issuesは公開されます。個人情報・社外秘情報・顧客データ等は記載しないでください。
